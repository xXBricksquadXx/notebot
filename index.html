<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Notebot.ai — Neo-brutalist notes with Markdown preview and optional AI chat via Groq." />
  <meta name="color-scheme" content="light dark" />
  <title>Notebot.ai</title>

  <!-- Tailwind CDN (utility help, optional) -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Markdown + Highlight -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <link rel="stylesheet" href="./styles.css" />
  <script src="./app.js" defer></script>
</head>

<body class="h-screen">
  <noscript>
    <div class="p-4 border-neo bg-surface m-4">
      This app requires JavaScript enabled.
    </div>
  </noscript>

  <div id="app" class="flex w-full h-full">
    <!-- Sidebar -->
    <aside id="sidebar" class="w-64 flex flex-col p-4 border-neo">
      <h1 class="text-3xl font-bold mb-8 text-primary">
        Notebot<span class="text-secondary">.ai</span>
      </h1>

      <nav class="flex-grow" aria-label="Primary navigation">
        <ul>
          <li class="mb-3">
            <button
              type="button"
              class="nav-item w-full text-left p-3 cursor-pointer hover:bg-primary hover:text-white transition-colors border-neo bg-surface"
              data-view="notes"
              aria-label="View Notes"
            >
              <i class="fas fa-sticky-note mr-2" aria-hidden="true"></i> Notes
            </button>
          </li>

          <li class="mb-3">
            <button
              type="button"
              class="nav-item w-full text-left p-3 cursor-pointer hover:bg-primary hover:text-white transition-colors border-neo bg-surface"
              data-view="archived"
              aria-label="View Archived Notes"
            >
              <i class="fas fa-archive mr-2" aria-hidden="true"></i> Archived
            </button>
          </li>

          <li class="mb-3">
            <button
              type="button"
              class="nav-item w-full text-left p-3 cursor-pointer hover:bg-primary hover:text-white transition-colors border-neo bg-surface"
              data-view="chatbot"
              aria-label="Access AI Chatbot"
            >
              <i class="fas fa-robot mr-2" aria-hidden="true"></i> Chatbot
            </button>
          </li>

          <li class="mb-3">
            <button
              type="button"
              class="nav-item w-full text-left p-3 cursor-pointer hover:bg-primary hover:text-white transition-colors border-neo bg-surface"
              data-view="settings"
              aria-label="Open Settings"
            >
              <i class="fas fa-cog mr-2" aria-hidden="true"></i> Settings
            </button>
          </li>
        </ul>
      </nav>

      <div class="mt-auto pt-4 border-t-2 border-border">
        <p class="text-sm text-muted-text">&copy; 2025 Notebot.ai</p>
      </div>
    </aside>

    <!-- Main -->
    <main id="content" class="flex-grow flex flex-col p-6 space-y-6 overflow-hidden">
      <!-- NOTES VIEW -->
      <section id="notes-view" class="flex-grow flex space-x-6 hidden" aria-label="Notes View">
        <!-- List -->
        <div class="w-1/3 flex flex-col border-neo bg-surface p-4 overflow-y-auto">
          <div class="flex items-center mb-4">
            <input
              type="text"
              id="notes-search-input"
              placeholder="Search notes..."
              class="flex-grow input-neo mr-2"
              aria-label="Search notes"
            >
            <button
              type="button"
              id="new-note-btn"
              class="btn-neo bg-accent text-background"
              title="New note"
              aria-label="Create new note"
            >
              <i class="fas fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div id="notes-list" class="flex-grow space-y-3" role="list"></div>
        </div>

        <!-- Editor -->
        <div id="note-editor" class="flex-grow flex flex-col border-neo bg-surface p-4 overflow-hidden">
          <input
            type="text"
            id="note-title-input"
            placeholder="Note Title"
            class="input-neo text-xl font-bold mb-4"
            aria-label="Note title"
          >

          <textarea
            id="note-content-input"
            placeholder="Write Markdown..."
            class="flex-grow input-neo mb-4 resize-none"
            aria-label="Note content"
          ></textarea>

          <div class="flex items-center mb-4">
            <input
              type="text"
              id="note-tags-input"
              placeholder="Tags (comma-separated)"
              class="input-neo flex-grow mr-2 text-sm"
              aria-label="Note tags"
            >
            <div id="note-tags-display" class="flex flex-wrap gap-1" aria-label="Tags display"></div>
          </div>

          <div class="flex justify-between items-center mb-4">
            <div class="flex space-x-2">
              <button type="button" id="note-pin-btn" class="btn-neo text-sm" aria-label="Pin note">
                <i class="fas fa-thumbtack mr-1" aria-hidden="true"></i> <span class="pin-text">Pin</span>
              </button>
              <button type="button" id="note-archive-btn" class="btn-neo text-sm" aria-label="Archive note">
                <i class="fas fa-box-archive mr-1" aria-hidden="true"></i> Archive
              </button>
              <button
                type="button"
                id="note-send-to-ai-btn"
                class="btn-neo text-sm bg-secondary text-background"
                aria-label="Send note to AI"
              >
                <i class="fas fa-robot mr-1" aria-hidden="true"></i> Send to AI
              </button>
            </div>

            <div class="flex space-x-2">
              <button type="button" id="note-export-md-btn" class="btn-neo text-sm" aria-label="Export as Markdown">
                <i class="fas fa-file-export mr-1" aria-hidden="true"></i> MD
              </button>
              <button type="button" id="note-export-txt-btn" class="btn-neo text-sm" aria-label="Export as Text">
                <i class="fas fa-file-export mr-1" aria-hidden="true"></i> TXT
              </button>
              <button type="button" id="note-delete-btn" class="btn-neo text-sm btn-danger" aria-label="Delete note">
                <i class="fas fa-trash mr-1" aria-hidden="true"></i> Delete
              </button>
            </div>
          </div>

          <div
            id="note-preview"
            class="flex-grow border-neo bg-background p-4 overflow-y-auto"
            aria-label="Markdown preview"
          >
            <div class="prose max-w-none text-text"></div>
          </div>
        </div>
      </section>

      <!-- ARCHIVED VIEW -->
      <section id="archived-view" class="flex-grow flex flex-col hidden" aria-label="Archived Notes View">
        <h2 class="text-2xl font-bold mb-4 text-primary">Archived Notes</h2>
        <div id="archived-notes-list" class="flex-grow border-neo bg-surface p-4 overflow-y-auto space-y-3"></div>
      </section>

      <!-- CHATBOT VIEW -->
      <section id="chatbot-view" class="flex-grow flex flex-col hidden" aria-label="Chatbot View">
        <h2 class="text-2xl font-bold mb-4 text-primary">AI Chatbot</h2>

        <div class="flex items-center mb-4">
          <label class="mr-2 text-muted-text" for="ai-mode-select">Mode:</label>
          <select id="ai-mode-select" class="input-neo mr-4" aria-label="AI mode">
            <option value="simulated">Simulated (no API)</option>
            <option value="serverless">Serverless (/api/chat)</option>
          </select>

          <button type="button" id="chatbot-new-session-btn" class="btn-neo bg-accent text-background mr-auto">
            <i class="fas fa-redo mr-1" aria-hidden="true"></i> New Session
          </button>

          <!-- IMPORTANT: matches app.js -->
          <button type="button" id="chatbot-save-chat-btn" class="btn-neo bg-secondary text-background">
            <i class="fas fa-save mr-1" aria-hidden="true"></i> Save Chat
          </button>
        </div>

        <div
          id="chat-history"
          class="flex-grow border-neo bg-background p-4 overflow-y-auto space-y-4"
          aria-label="Chat history"
        ></div>

        <div
          id="chatbot-typing-indicator"
          class="text-muted-text text-sm mt-2 mb-4 hidden"
          aria-live="polite"
        >
          <i class="fas fa-ellipsis-h animate-pulse mr-1" aria-hidden="true"></i> AI is typing...
        </div>

        <div class="flex flex-wrap gap-2 mb-4" aria-label="Prompt templates">
          <button type="button" class="prompt-template-btn btn-neo text-xs" data-template="Summarize this note:\n\n">Summarize</button>
          <button type="button" class="prompt-template-btn btn-neo text-xs" data-template="Extract action items:\n\n">Action items</button>
          <button type="button" class="prompt-template-btn btn-neo text-xs" data-template="Rewrite in a professional tone:\n\n">Rewrite</button>
          <button type="button" class="prompt-template-btn btn-neo text-xs" data-template="Generate ideas for:\n\n">Ideas</button>
        </div>

        <div class="flex">
          <textarea
            id="chat-input"
            placeholder="Type your message..."
            class="flex-grow input-neo resize-none h-12 mr-2"
            aria-label="Chat input"
          ></textarea>
          <button type="button" id="send-chat-btn" class="btn-neo bg-primary text-white" aria-label="Send Message">
            <i class="fas fa-paper-plane" aria-hidden="true"></i>
          </button>
        </div>
      </section>

      <!-- SETTINGS VIEW -->
      <section id="settings-view" class="flex-grow flex flex-col hidden" aria-label="Settings View">
        <h2 class="text-2xl font-bold mb-4 text-primary">Settings</h2>

        <div class="flex-grow border-neo bg-surface p-6 overflow-y-auto space-y-8">
          <div>
            <h3 class="text-xl font-semibold mb-4 text-accent">Theme</h3>
            <div class="flex items-center">
              <span class="mr-4">Dark Mode:</span>
              <label class="switch">
                <input type="checkbox" id="dark-mode-toggle" aria-label="Toggle dark mode">
                <span class="slider round"></span>
              </label>
            </div>
          </div>

          <div>
            <h3 class="text-xl font-semibold mb-2 text-accent">Serverless</h3>
            <p class="text-sm text-muted-text">
              CodePen cannot host /api/chat. Use “Simulated” in Chatbot mode there.
              In GitHub/Vercel you’ll switch to “Serverless”.
            </p>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal -->
  <div
    id="modal-container"
    class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden"
    role="dialog"
    aria-modal="true"
  >
    <div id="confirmation-modal" class="bg-surface p-6 border-neo w-96 relative">
      <h3 id="modal-title" class="text-xl font-bold mb-4 text-primary">Confirmation</h3>
      <p id="modal-message" class="mb-6 text-text">Are you sure?</p>
      <div class="flex justify-end space-x-4">
        <button type="button" id="modal-cancel-btn" class="btn-neo bg-gray-500 text-white">Cancel</button>
        <button type="button" id="modal-confirm-btn" class="btn-neo btn-danger">Confirm</button>
      </div>
      <button
        type="button"
        id="modal-close-btn"
        class="absolute top-2 right-4 text-2xl font-bold text-muted-text hover:text-white"
        aria-label="Close modal"
      >
        &times;
      </button>
    </div>
  </div>

  <!-- Toasts -->
  <div id="toast-container" class="fixed bottom-4 right-4 z-50 space-y-3" role="status" aria-live="polite"></div>
</body>
</html>
